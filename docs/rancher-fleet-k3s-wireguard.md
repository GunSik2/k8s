
# Rancher - Fleet - K3s - Wireguard

## 환경 구성
- Rancher + Fleet 이용한 서버
- Raspberry-pi 에 설치한 K3S + Fleet agent 설치
- 양단 간 wireguard 구성

## Rancher + Fleet + Wireguard
- 서버환경 ubuntu 16.04.6 
- Rancher 설치
- Wireguard 설치
```
sudo apt-get install wireguard

# we had to enable IP forwarding on the cloud VM, to route traffic between rancher and the Raspberry Pi, 
sysctl -w net.ipv4.ip_forward=1   

# generate the public and the private keys for our WireGuard tunnel
cd /etc/wireguard
wg genkey | tee privatekey | wg pubkey > publickey

# /etc/wireguard/wg0.conf
------
[Interface]

# The IP address of this host in the wireguard tunnels
Address = 10.222.0.1   

# Every Raspberry Pi connects via UDP to this port.
ListenPort = 51871     

# Set the private key to the value of the privatekey file generated by the previous command
PrivateKey = xdjT4G7J9DFkHgP37yr4kS8SVow8Kj5oxwkzA2FZ7jI=  

# Set the MTU according to the internet connections of your clients
MTU = 1420
------

```


## 참고자료
- https://www.inovex.de/de/blog/how-to-set-up-a-k3s-cluster-on-wireguard/ 
- https://www.wireguard.com/quickstart/
- https://www.ivpn.net/knowledgebase/linux/linux-wireguard-rtnetlink-answers-operation-not-supported/
